<!doctype html>
<html>

<head>
  <meta charset="utf-8">
  <title>Hectomancy</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Open+Sans:ital,wght@0,300..800;1,300..800&display=swap"
    rel="stylesheet">
  <style>
    * {
      box-sizing: border-box;
    }

    html,
    body {
      margin: 0;
      padding: 0;
      height: 100%;
      background-color: #fff;
      color: #000;
    }

    body {
      font-family: "Open Sans", sans-serif;
      font-optical-sizing: auto;
      font-style: normal;
      font-size: 12px;
    }

    .win {
      display: flex;
      justify-content: center;
    }

    .bar {
      font-size: 2vh;
      width: 5em;
      font-weight: 100;
      position: fixed;
      top: 0;
      left: 0;
      background-color: #fff;
      padding: 0.5rem;
      text-align: center;
      z-index: 20;
    }

    @media print {
      .bar {
        display: none;
      }
    }

    .bar a {
      display: block;
      text-decoration: none;
      padding: 0.5ex 0;
      color: #888;
      border: 1px solid transparent;
    }

    .bar a.active,
    .bar a:hover {
      border-color: #000;
      color: #000
    }


    #main.horizontal img {
      transform: rotate(-90deg);
    }

    .row {
      display: flex;
      justify-content: center;
    }

    figure {
      position: relative;
    }

    figure.card,
    figure.back {
      height: 33.3vh;
      margin: 0;
      padding: 0 0.5rem 0 0.5rem;
      display: flex;
      align-items: center;
    }

    figure.card {
      flex-direction: column;
    }

    figure.card>h4 {
      font-size: 16px;
      text-align: center;
      margin: 0;
      padding: 0;
      flex-shrink: 0;
    }

    figure.card>p {
      font-size: 12px;
      text-align: center;
      margin: 0;
      padding: 0;
      flex-shrink: 0;
    }

    figure.card>img {
      max-height: calc(32vh - 3.5rem);
    }


    figure.card button {
      display: none;
    }

    figure.card.modal button {
      display: block;
      position: absolute;
      top: 1rem;
      right: 1rem;
    }

    figure.card.modal img {
      max-height: calc(100% - 2rem);
      max-width: 100%;
    }


    figure.card.modal {
      position: absolute;
      z-index: 10;
      top: 0;
      left: 0;
      height: 100vh;
      width: 100%;
    }

    figure.back figcaption {
      text-align: center;
      margin-left: -0.07em;
      font-size: 25vh;
      line-height: 100%;
      font-style: italic;
      font-weight: 100;
      font-family: Garamond, serif;
    }

    figure.back time {
      position: absolute;
      color: #ccc !important;
      font-size: 1vh;
      right: 1ex;
      bottom: 0;
    }

    .page.back {
      display: none;
    }

    form {
      text-align: center;
    }

    button {
      font-family: monospace;
    }

    @page {
      size: A4;
      margin: 0;
    }

    @media print {



      .page {
        margin: 0;
        padding: 1cm 0 0 0;
        width: 210mm;
        height: 297mm;
      }

      #aside,
      form {
        display: none;
      }

      .page.back {
        display: block;
      }



      figure.back,
      figure.card {
        height: 3.5in;
        width: 2.5in;
        box-sizing: content-box;
        /* size without borders */
        margin: 0;
        padding: 0;
        display: flexbox;
        flex-direction: column;
        justify-content: space-between;
      }

      /* print borders */

      .page>.row:first-child {
        border-top: 0.002in solid transparent;
      }

      .row {
        border-bottom: 0.002in solid transparent;
      }

      .row>figure:first-child {
        border-left: 0.002in solid transparent;
      }

      .row>figure {
        border-right: 0.002in solid transparent;
      }

      figure.back,
      .page.back .row {
        border-color: #aaa !important;
      }


      figure.card img {
        width: 2.3in;
        height: 2.3in;
      }

      figure.card {
        position: relative;
      }


      figure.card>h4 {
        padding-top: 0.25in;
        font-size: 5.5mm;
        font-weight: 500;
      }

      figure.card>p {
        padding-bottom: 0.25in;
      }

      figure.back figcaption {
        margin-left: -0.07em;
        font-size: 3.5in;
      }

      figure.back time {
        font-size: 0.08in;
        right: 0.03in;
        bottom: 0;
      }
    }
  </style>
  <script src="hectomancy.js">//</script>
</head>

<body>
  <template id="card-tpl">
    <figure class="card">
      <h4></h4>
      <button type="button">Ã—</button>
      <img loading="lazy" decoding="async"/>
      <p></p>
    </figure>
  </template>
  <template id="back-tpl">
    <figure class="back">
      <figcaption>h</figcaption>
      <time></time>
    </figure>
  </template>
  <div class="win">
    <nav class="bar" id="bar">
      <a href="#d0">01-09</a>
      <a href="#d1">11-19</a>
      <a href="#d2">21-29</a>
      <a href="#d3">31-39</a>
      <a href="#d4">41-49</a>
      <a href="#d5">51-59</a>
      <a href="#d6">61-69</a>
      <a href="#d7">71-79</a>
      <a href="#d8">81-89</a>
      <a href="#d9">91-99</a>
      <a href="#u0">[1-9]0</a>
      <a href="#u1">[1-9]1</a>
      <a href="#u2">[1-9]2</a>
      <a href="#u3">[1-9]3</a>
      <a href="#u4">[1-9]4</a>
      <a href="#u5">[1-9]5</a>
      <a href="#u6">[1-9]6</a>
      <a href="#u7">[1-9]7</a>
      <a href="#u8">[1-9]8</a>
      <a href="#u9">[1-9]9</a>
      <a href="#p0">divers</a>
    </nav>
    <div id="pages">

    </div>
  </div>
  <script>
    (function () {
      const pages = document.getElementById("pages");
      const cardTpl = document.getElementById("card-tpl");
      const now = new Date();
      const stamp = now.toISOString().substring(0, 10);
      const backTpl = document.getElementById("back-tpl");

      for (let page = 0; page < 10; page++) {
        /*
         * 9 3 7
         * 1 5 2
         * 8 4 6
         */
        const offset = page * 10;
        const series = [9, 3, 7, 1, 5, 2, 8, 4, 6];
        series.forEach((n, i) => {
          series[i] = n + offset;
        });
        const node = front(series);
        node.id = "d" + page;
        pages.appendChild(node);
        pages.appendChild(back());
      }
      let node = front([90, 30, 70, 10, 50, 20, 80, 40, 60]);
      node.id = "u0";
      pages.appendChild(node);
      pages.appendChild(back());
      node = front(news);
      node.id = "p0";
      pages.appendChild(node);
      pages.appendChild(back());

      const bar = document.getElementById("bar");
      let active = bar.querySelector('a[href^="#"].active') || null;

      bar.addEventListener("click", (e) => {
        const a = e.target.closest('a[href^="#"]');
        if (!a || !bar.contains(a)) return;

        if (active === a) return;

        if (active) active.classList.remove("active");
        a.classList.add("active");
        active = a;
      });

      function onRoute(event) {
        const hash = location.hash.slice(1);
        if (!hash) return;
        if (hash == 'p0') {
          repaint(news);
        }
        if (document.getElementById(hash)) return;
        if (hash[0] === 'u') {
          const n = Number(hash[1]);
          unit(n);
          scrollToId('p0');
          event.preventDefault();
          return;
        }
      }

      function scrollToId(id) {
        const el = document.getElementById(id);
        if (!el) return false;
        el.scrollIntoView({ block: "start", behavior: "auto" }); // or "smooth"
        return true;
      }

window.addEventListener("hashchange", onRoute);
window.addEventListener("DOMContentLoaded", onRoute); // initial

      function unit(n) {
        const series = [90, 30, 70, 10, 50, 20, 80, 40, 60];
        series.forEach((ten, i) => {
          series[i] = ten + n;
        });
        repaint(series);
      }

      function repaint(series) {
        const page = document.getElementById("p0");
        const figures = page.querySelectorAll("figure");
        figures.forEach((fig, i) => {
          const n = series[i];
          card(n, fig);
        });
      }

      function front(series) {
        const page = document.createElement("div");
        page.className = "page front";
        for (let row = 0; row < 3; row++) {
          const rowDiv = document.createElement("div");
          rowDiv.className = "row";
          for (let col = 0; col < 3; col++) {
            const n = series[row * 3 + col];
            rowDiv.appendChild(card(n));
          }
          page.appendChild(rowDiv);
        }
        return page;
      }


      function back() {
        const page = document.createElement("div");
        page.className = "page back";
        for (let row = 0; row < 3; row++) {
          const rowDiv = document.createElement("div");
          rowDiv.className = "row";
          for (let col = 0; col < 3; col++) {
            const node = backTpl.content.firstElementChild.cloneNode(true);
            node.querySelector("time").textContent = stamp;
            rowDiv.appendChild(node);
          }
          page.appendChild(rowDiv);
        }
        return page;
      }

      function card(n, node=cardTpl.content.firstElementChild.cloneNode(true)) {
        const no = ('' + Number(n)).padStart(2, '0');
        let name = no;
        if (hecto[no]["verb"]) name += ', ' + hecto[no]["verb"];
        node.id = "hecto" + no;
        node.querySelector("h4").textContent = name;
        node.querySelector("p").textContent = hecto[no]["formula"] || "";
        const img = node.querySelector("img");
        img.src = "hecto" + no + '.jpg';
        img.alt = no;
        node.addEventListener("click", function (event) {
          node.classList.toggle("modal");
        }, true);
        return node;
      }



    })();
  </script>
</body>

</html>